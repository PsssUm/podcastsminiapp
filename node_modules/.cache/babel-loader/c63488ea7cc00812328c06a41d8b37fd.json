{"ast":null,"code":"var _jsxFileName = \"/Users/spbiphones/Dropbox/projects/web projects/podcasts/src/pages/custom_views/UploadPodcast.js\";\nimport React from 'react';\nimport podcast_icon from \"../../resources/icons/podcast_icon.svg\";\nimport moment from 'moment';\nvar objectUrl;\n\nclass UploadPodcast extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.getDuration = file => {\n      objectUrl = URL.createObjectURL(file);\n      window.document.getElementById(\"audio\").src = objectUrl;\n      window.document.getElementById(\"audio\").addEventListener(\"canplaythrough\", this.onCanPlayAudio);\n    };\n\n    this.onCanPlayAudio = e => {\n      var seconds = e.currentTarget.duration;\n      var duration = moment.duration(seconds, \"seconds\");\n      var time = \"\";\n      var hours = duration.hours();\n\n      if (hours > 0) {\n        time = hours + \":\";\n      }\n\n      time = time + duration.minutes() + \":\" + duration.seconds();\n      URL.revokeObjectURL(objectUrl);\n      this.setState({\n        duration: time\n      });\n      this.props.durationChanged(time);\n    };\n\n    this.isPodcastPicker = this.props.podcast.audioFile != undefined;\n    this.state = {\n      isPickedPodcast: this.isPodcastPicker,\n      name: \"\",\n      duration: \"\"\n    };\n    this.fileUpload = React.createRef();\n    this.podcastContainer = React.createRef();\n    this.showPickedPodcast = this.showPickedPodcast.bind(this);\n    this.pickPodcast = this.pickPodcast.bind(this);\n    this.fileChangedHandler = this.fileChangedHandler.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.isPodcastPicker) {\n      console.log(\"this.isPodcastPicker = \" + this.isPodcastPicker);\n      this.props.podcastPicked(this.props.podcast.audioFile);\n      this.getDuration(this.props.podcast.audioFile);\n      this.setState({\n        name: this.props.podcast.audioFile.name\n      });\n    }\n  }\n\n  showPickedPodcast() {\n    this.setState({\n      isPickedPodcast: true\n    });\n  }\n\n  pickPodcast() {\n    this.fileUpload.current.click();\n  }\n\n  fileChangedHandler(event) {\n    if (event && event.target.files && event.target.files.length > 0) {\n      // const urlObj = URL.createObjectURL(event.target.files[0])\n      const file = event.target.files[0];\n      this.showPickedPodcast();\n      this.setState({\n        name: file.name\n      });\n      this.props.podcastPicked(file);\n      this.getDuration(file);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"podcastContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      id: \"fileInput\",\n      className: \"custom-file-input hover\",\n      type: \"file\",\n      accept: \".mp3\",\n      onChange: this.fileChangedHandler,\n      style: {\n        display: \"none\"\n      },\n      ref: this.fileUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }), React.createElement(\"audio\", {\n      style: {\n        display: 'none'\n      },\n      id: \"audio\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }), !this.state.isPickedPodcast ? React.createElement(\"div\", {\n      className: \"upload_podcast_container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"upload_podcast_title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0412\\u0430\\u0448 \\u043F\\u043E\\u0434\\u043A\\u0430\\u0441\\u0442\"), React.createElement(\"p\", {\n      className: \"create_donation_text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0433\\u043E\\u0442\\u043E\\u0432\\u044B\\u0439 \\u0430\\u0443\\u0434\\u0438\\u043E\\u0444\\u0430\\u0439\\u043B \\u0438\\u0437 \\u0432\\u0430\\u0448\\u0435\\u0433\\u043E \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \\u0438 \\u0434\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u0435\\u0433\\u043E\"), React.createElement(\"div\", {\n      onClick: this.pickPodcast,\n      className: \"stroke_button center_btn_upload hover\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\")) : React.createElement(\"div\", {\n      className: \"podcast_uploaded_container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      onClick: this.pickPodcast,\n      className: \"flex just_content hover\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"flex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"podcast_icon_picked\",\n      src: podcast_icon,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"podcast_title_picked\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, this.state.name)), React.createElement(\"p\", {\n      className: \"time_podcast_picked\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, this.state.duration)), React.createElement(\"p\", {\n      className: \"podcast_picked_decr\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"\\u0412\\u044B \\u043C\\u043E\\u0436\\u0435\\u0442\\u0435 \\u0434\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u0430\\u0439\\u043C\\u043A\\u043E\\u0434\\u044B \\u0438 \\u0441\\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E\\u0434\\u043A\\u0430\\u0441\\u0442 \\u0432 \\u0440\\u0435\\u0436\\u0438\\u043C\\u0435 \\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\"), React.createElement(\"div\", {\n      onClick: () => this.props.openEdit(),\n      className: \"large_stroke_button hover\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u0430\\u0443\\u0434\\u0438\\u043E\\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\")), React.createElement(\"div\", {\n      className: \"navbar_line details_line\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default UploadPodcast;","map":{"version":3,"sources":["/Users/spbiphones/Dropbox/projects/web projects/podcasts/src/pages/custom_views/UploadPodcast.js"],"names":["React","moment","objectUrl","UploadPodcast","Component","constructor","props","getDuration","file","URL","createObjectURL","window","document","getElementById","src","addEventListener","onCanPlayAudio","e","seconds","currentTarget","duration","time","hours","minutes","revokeObjectURL","setState","durationChanged","isPodcastPicker","podcast","audioFile","undefined","state","isPickedPodcast","name","fileUpload","createRef","podcastContainer","showPickedPodcast","bind","pickPodcast","fileChangedHandler","componentDidMount","console","log","podcastPicked","current","click","event","target","files","length","render","display","podcast_icon","openEdit"],"mappings":"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","sourcesContent":["import React from 'react';\nimport podcast_icon from '../../resources/icons/podcast_icon.svg'\nimport moment from 'moment'\nvar objectUrl;\nclass UploadPodcast extends React.Component {\n   \n    constructor(props){\n        super(props)\n        this.isPodcastPicker = (this.props.podcast.audioFile != undefined)\n        this.state = {\n            isPickedPodcast : this.isPodcastPicker,\n            name : \"\",\n            duration : \"\",\n        }\n        this.fileUpload = React.createRef();\n        this.podcastContainer = React.createRef();\n        this.showPickedPodcast = this.showPickedPodcast.bind(this)\n        this.pickPodcast = this.pickPodcast.bind(this)\n        this.fileChangedHandler = this.fileChangedHandler.bind(this);\n        \n    }\n    componentDidMount(){\n        \n        if (this.isPodcastPicker){\n            console.log(\"this.isPodcastPicker = \" + this.isPodcastPicker)\n            this.props.podcastPicked(this.props.podcast.audioFile)\n            this.getDuration(this.props.podcast.audioFile)\n            this.setState({name : this.props.podcast.audioFile.name})\n        }\n    }\n    showPickedPodcast(){\n        this.setState({isPickedPodcast : true})\n    }\n    pickPodcast(){\n        this.fileUpload.current.click();\n    }\n    \n    fileChangedHandler(event) {\n        if(event && event.target.files && event.target.files.length > 0){\n            // const urlObj = URL.createObjectURL(event.target.files[0])\n            const file = event.target.files[0]\n            this.showPickedPodcast()\n            this.setState({name : file.name})\n            this.props.podcastPicked(file)\n            this.getDuration(file)\n\n        }\n    }\n    getDuration = (file) => {\n        objectUrl = URL.createObjectURL(file);\n        window.document.getElementById(\"audio\").src = objectUrl\n        window.document.getElementById(\"audio\").addEventListener(\"canplaythrough\", this.onCanPlayAudio)\n        \n    }\n    onCanPlayAudio = (e) =>{\n        var seconds = e.currentTarget.duration;\n        var duration = moment.duration(seconds, \"seconds\");\n        \n        var time = \"\";\n        var hours = duration.hours();\n        if (hours > 0) { time = hours + \":\" ; }\n        \n        time = time + duration.minutes() + \":\" + duration.seconds();\n        \n        URL.revokeObjectURL(objectUrl);\n        this.setState({duration : time})\n        this.props.durationChanged(time)\n    }\n  \n    render() {\n        return (\n            <div id=\"podcastContainer\">\n                <input id=\"fileInput\" className=\"custom-file-input hover\" type=\"file\" accept=\".mp3\" onChange={this.fileChangedHandler} style={{ display: \"none\" }} ref={this.fileUpload}/>\n                <audio style={{display : 'none'}} id=\"audio\"></audio>\n                {!this.state.isPickedPodcast ? \n                <div className=\"upload_podcast_container\">\n                    <p className=\"upload_podcast_title\">Загрузите Ваш подкаст</p>\n                    <p className=\"create_donation_text\">Выберите готовый аудиофайл из вашего телефона и добавьте его</p>\n                    <div onClick={this.pickPodcast} className=\"stroke_button center_btn_upload hover\">Загрузить файл</div>\n                </div> :\n                <div className=\"podcast_uploaded_container\">\n                    <div onClick={this.pickPodcast} className=\"flex just_content hover\">\n                        <div className=\"flex\">\n                            <img className=\"podcast_icon_picked\" src={podcast_icon}/>\n                            <p className=\"podcast_title_picked\">{this.state.name}</p>\n                        </div>\n                        <p className=\"time_podcast_picked\">{this.state.duration}</p>\n                    </div>\n                    <p className=\"podcast_picked_decr\">Вы можете добавить таймкоды и скорректировать подкаст в режиме редактирования</p>\n                    <div onClick={() => this.props.openEdit()} className=\"large_stroke_button hover\">Редактировать аудиозапись</div>\n                    \n                </div>}\n                <div className=\"navbar_line details_line\"/>\n                \n                \n            </div>\n        );\n    }\n}\nexport default UploadPodcast;"]},"metadata":{},"sourceType":"module"}